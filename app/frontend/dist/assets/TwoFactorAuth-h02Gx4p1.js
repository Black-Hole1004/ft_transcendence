import{c as y,a as j,u as k,b as N,j as t,k as v,h as c}from"./index-B4bz0GvT.js";import{AlertWrapper as w}from"./Layout-D37kEgpn.js";import"./Button-DzeJS1SW.js";const A="https://localhost",E=A,_=()=>{const l=y(),{setAuthTokens:g,setUser:h}=j(),{email:d,password:u}=l.state||{},p=k(),n=(e,r)=>{e!=null&&e.value.length&&(e.value.charCodeAt(0)>=48&&e.value.charCodeAt(0)<=57?document.getElementById(r).focus():e.value="")},s=(e,r,o)=>{e==="Backspace"&&(r!=null&&r.value.length?r.value="":o&&document.getElementById(o).focus())},{triggerAlert:m}=N(),b=(e,r)=>{m(e,r)},f=async()=>{try{let e="";const r=document.getElementsByTagName("input");Array.from(r).forEach(i=>{e+=i.value});const o=await fetch(`${E}/api/user/2fa/verify/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,password:u,otp:e})}),a=await o.json();if(o.ok){g(a),h(v(a.access_token));const i=JSON.stringify(a.access_token),x=JSON.stringify(a.refresh_token);c.set("refresh_token",x,{sameSite:"None",secure:!0}),c.set("access_token",i,{sameSite:"None",secure:!0}),p("/dashboard")}else b("error","Something went wrong")}catch(e){console.error("error",e)}};return t.jsx(t.Fragment,{children:t.jsxs("section",{className:"relative w-full h-screen text-primary backdrop-blur-md backdrop-brightness-50",children:[t.jsx(w,{layout:!1}),t.jsxs("div",{className:"flex flex-col absolute container top-1/2 left-1/2 text-center text-primary",children:[t.jsx("h1",{className:"modal-title font-heavy",children:"Enter code"}),t.jsxs("p",{className:"font-regular paragraph",children:["Enter the 6-digit code sent to your ",d," address"]}),t.jsxs("div",{className:"user-input flex justify-center gap-2 font-heavy pt-20",children:[t.jsx("input",{id:"first",type:"text",maxLength:1,className:"inputs text-center border border-border rounded bg-[rgb(183,170,156,8%)]",onChange:e=>n(e.target,"second"),onKeyDown:e=>s(e.key,e.target,null)}),t.jsx("input",{id:"second",type:"text",maxLength:1,className:"inputs text-center border border-border rounded bg-[rgb(183,170,156,8%)]",onChange:e=>n(e.target,"third"),onKeyDown:e=>s(e.key,e.target,"first")}),t.jsx("input",{id:"third",type:"text",maxLength:1,className:"inputs text-center border border-border rounded bg-[rgb(183,170,156,8%)]",onChange:e=>n(e.target,"fourth"),onKeyDown:e=>s(e.key,e.target,"second")}),t.jsx("div",{className:"bg-primary tb:h-3 h-2 mx-2 self-center rounded-sm sep"}),t.jsx("input",{id:"fourth",type:"text",maxLength:1,className:"inputs text-center border border-border rounded bg-[rgb(183,170,156,8%)] ",onChange:e=>n(e.target,"fifth"),onKeyDown:e=>s(e.key,e.target,"third")}),t.jsx("input",{id:"fifth",type:"text",maxLength:1,className:"inputs text-center border border-border rounded bg-[rgb(183,170,156,8%)] ",onChange:e=>n(e.target,"sixth"),onKeyDown:e=>s(e.key,e.target,"fourth")}),t.jsx("input",{id:"sixth",type:"text",maxLength:1,className:"inputs text-center border border-border rounded bg-[rgb(183,170,156,8%)]",onKeyDown:e=>s(e.key,e.target,"fifth")})]}),t.jsx("button",{onClick:f,className:`verify border border-border text-primary font-medium select-none py-2 px-10 my-10 self-center
						rounded bg-[rgb(183,170,156,12%)] transition-all duration-300 ease-in-out hover:bg-[rgb(183,170,156,30%)]`,children:"Verify"})]})]})})};export{_ as default};
